{"ast":null,"code":"'use strict';\n\nvar _objectSpread = require(\"C:/Users/sakas/OneDrive/Desktop/gogo/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nconst tls = require('tls');\nconst http = require('http');\nconst https = require('https');\nconst JSStreamSocket = require('../utils/js-stream-socket.js');\nconst {\n  globalAgent\n} = require('../agent.js');\nconst UnexpectedStatusCodeError = require('./unexpected-status-code-error.js');\nconst initialize = require('./initialize.js');\nconst getAuthorizationHeaders = require('./get-auth-headers.js');\nconst createConnection = (self, options, callback) => {\n  (async () => {\n    try {\n      const {\n        proxyOptions\n      } = self;\n      const {\n        url,\n        headers,\n        raw\n      } = proxyOptions;\n      const stream = await globalAgent.request(url, proxyOptions, _objectSpread(_objectSpread(_objectSpread({}, getAuthorizationHeaders(self)), headers), {}, {\n        ':method': 'CONNECT',\n        ':authority': \"\".concat(options.host, \":\").concat(options.port)\n      }));\n      stream.once('error', callback);\n      stream.once('response', headers => {\n        const statusCode = headers[':status'];\n        if (statusCode !== 200) {\n          callback(new UnexpectedStatusCodeError(statusCode, ''));\n          return;\n        }\n        const encrypted = self instanceof https.Agent;\n        if (raw && encrypted) {\n          options.socket = stream;\n          const secureStream = tls.connect(options);\n          secureStream.once('close', () => {\n            stream.destroy();\n          });\n          callback(null, secureStream);\n          return;\n        }\n        const socket = new JSStreamSocket(stream);\n        socket.encrypted = false;\n        socket._handle.getpeername = out => {\n          out.family = undefined;\n          out.address = undefined;\n          out.port = undefined;\n        };\n        callback(null, socket);\n      });\n    } catch (error) {\n      callback(error);\n    }\n  })();\n};\nclass HttpOverHttp2 extends http.Agent {\n  constructor(options) {\n    super(options);\n    initialize(this, options.proxyOptions);\n  }\n  createConnection(options, callback) {\n    createConnection(this, options, callback);\n  }\n}\nclass HttpsOverHttp2 extends https.Agent {\n  constructor(options) {\n    super(options);\n    initialize(this, options.proxyOptions);\n  }\n  createConnection(options, callback) {\n    createConnection(this, options, callback);\n  }\n}\nmodule.exports = {\n  HttpOverHttp2,\n  HttpsOverHttp2\n};","map":{"version":3,"names":["_objectSpread","require","default","tls","http","https","JSStreamSocket","globalAgent","UnexpectedStatusCodeError","initialize","getAuthorizationHeaders","createConnection","self","options","callback","proxyOptions","url","headers","raw","stream","request","concat","host","port","once","statusCode","encrypted","Agent","socket","secureStream","connect","destroy","_handle","getpeername","out","family","undefined","address","error","HttpOverHttp2","constructor","HttpsOverHttp2","module","exports"],"sources":["C:/Users/sakas/OneDrive/Desktop/gogo/node_modules/http2-wrapper/source/proxies/h1-over-h2.js"],"sourcesContent":["'use strict';\nconst tls = require('tls');\nconst http = require('http');\nconst https = require('https');\nconst JSStreamSocket = require('../utils/js-stream-socket.js');\nconst {globalAgent} = require('../agent.js');\nconst UnexpectedStatusCodeError = require('./unexpected-status-code-error.js');\nconst initialize = require('./initialize.js');\nconst getAuthorizationHeaders = require('./get-auth-headers.js');\n\nconst createConnection = (self, options, callback) => {\n\t(async () => {\n\t\ttry {\n\t\t\tconst {proxyOptions} = self;\n\t\t\tconst {url, headers, raw} = proxyOptions;\n\n\t\t\tconst stream = await globalAgent.request(url, proxyOptions, {\n\t\t\t\t...getAuthorizationHeaders(self),\n\t\t\t\t...headers,\n\t\t\t\t':method': 'CONNECT',\n\t\t\t\t':authority': `${options.host}:${options.port}`\n\t\t\t});\n\n\t\t\tstream.once('error', callback);\n\t\t\tstream.once('response', headers => {\n\t\t\t\tconst statusCode = headers[':status'];\n\n\t\t\t\tif (statusCode !== 200) {\n\t\t\t\t\tcallback(new UnexpectedStatusCodeError(statusCode, ''));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst encrypted = self instanceof https.Agent;\n\n\t\t\t\tif (raw && encrypted) {\n\t\t\t\t\toptions.socket = stream;\n\t\t\t\t\tconst secureStream = tls.connect(options);\n\n\t\t\t\t\tsecureStream.once('close', () => {\n\t\t\t\t\t\tstream.destroy();\n\t\t\t\t\t});\n\n\t\t\t\t\tcallback(null, secureStream);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst socket = new JSStreamSocket(stream);\n\t\t\t\tsocket.encrypted = false;\n\t\t\t\tsocket._handle.getpeername = out => {\n\t\t\t\t\tout.family = undefined;\n\t\t\t\t\tout.address = undefined;\n\t\t\t\t\tout.port = undefined;\n\t\t\t\t};\n\n\t\t\t\tcallback(null, socket);\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tcallback(error);\n\t\t}\n\t})();\n};\n\nclass HttpOverHttp2 extends http.Agent {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tinitialize(this, options.proxyOptions);\n\t}\n\n\tcreateConnection(options, callback) {\n\t\tcreateConnection(this, options, callback);\n\t}\n}\n\nclass HttpsOverHttp2 extends https.Agent {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tinitialize(this, options.proxyOptions);\n\t}\n\n\tcreateConnection(options, callback) {\n\t\tcreateConnection(this, options, callback);\n\t}\n}\n\nmodule.exports = {\n\tHttpOverHttp2,\n\tHttpsOverHttp2\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}